(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{423:function(e,t,i){},431:function(e,t,i){"use strict";var s=i(423);i.n(s).a},435:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"container container--new"},[i("div",{staticClass:"new"},[i("div",{staticClass:"new__title"},[e._v("Блок «Отзывы»")]),i("div",{staticClass:"group-works__title"},[e._v(e._s("edit"===e.mode?"Редактировать работу":"Добавить отзыв"))]),i("div",{staticClass:"group__separator"}),i("div",{staticClass:"new__section"},[i("form",{staticClass:"group group--new",class:{hide:e.addFormVisible},on:{submit:function(t){return t.preventDefault(),e.addNewReview(t)}}},[i("div",{staticClass:"group__left"},["new"===e.mode?i("label",{staticClass:"group__left-upload"},[i("div",{staticClass:"group__left-img",class:{filled:e.photoUrl.length},style:{backgroundImage:"url("+e.photoUrl+")"}}),i("input",{staticClass:"group__left-file",attrs:{type:"file"},on:{change:e.loadPhoto}}),e._m(0)]):"edit"===e.mode?i("label",{staticClass:"group__left-upload"},[e.photoUrl.length?i("div",{staticClass:"group__left-img filled",class:{filled:e.photoUrl.length},style:{backgroundImage:"url("+e.photoUrl+")"}}):i("div",{staticClass:"group__left-img filled",class:{filled:e.photoUrl.length},style:{backgroundImage:"url("+e.image+")"}}),i("input",{staticClass:"group__left-file",attrs:{type:"file"},on:{change:e.loadPhoto}}),i("div",{staticClass:"group__left-text"},[e._v("Изменить фото")])]):e._e()]),i("div",{staticClass:"group__right"},[i("div",{staticClass:"group__row"},[i("label",{staticClass:"group__label"},[i("div",{staticClass:"group__label-text"},[e._v("Имя автора")]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.review.author,expression:"review.author"}],staticClass:"group__input-new",attrs:{type:"text"},domProps:{value:e.review.author},on:{input:function(t){t.target.composing||e.$set(e.review,"author",t.target.value)}}}),i("div",{staticClass:"tooltip"})]),i("label",{staticClass:"group__label"},[i("div",{staticClass:"group__label-text"},[e._v("Титул автора")]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.review.occ,expression:"review.occ"}],staticClass:"group__input-new",attrs:{type:"text"},domProps:{value:e.review.occ},on:{input:function(t){t.target.composing||e.$set(e.review,"occ",t.target.value)}}}),i("div",{staticClass:"tooltip"})])]),i("div",{staticClass:"group__row"},[i("label",{staticClass:"group__label"},[i("div",{staticClass:"group__label-text"},[e._v("Отзыв")]),i("textarea",{directives:[{name:"model",rawName:"v-model",value:e.review.text,expression:"review.text"}],staticClass:"group__textarea",attrs:{type:"text"},domProps:{value:e.review.text},on:{input:function(t){t.target.composing||e.$set(e.review,"text",t.target.value)}}}),i("div",{staticClass:"tooltip"})])]),i("div",{staticClass:"group__controls"},[i("button",{staticClass:"group__controls-cancell",on:{click:function(t){return t.preventDefault(),e.closeAddForm(t)}}},[e._v("Отменить")]),i("button",{staticClass:"group__btn",on:{click:function(t){t.preventDefault(),"new"==e.mode?e.addNewReview():e.updateUserRev()}}},[e._v("Сохранить")])])])])]),i("div",{staticClass:"new__section"},[i("div",{staticClass:"new__item new__item--line new__item--adding",on:{click:function(t){return e.showAddForm("new")}}},[e._m(1)]),e._l(e.reviews,(function(t){return i("review-item",{key:e.reviews.id,attrs:{review:t},on:{editUserRev:function(t){return e.showAddForm("edit")}}})}))],2)])])};s._withStripped=!0;var r=i(66);function o(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function n(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?o(i,!0).forEach((function(t){a(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):o(i).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function a(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var l={components:{reviewItem:function(){return i.e(11).then(i.bind(null,442))}},data:function(){return{photoUrl:"",hiddenForm:!0,review:{photo:"",author:"",text:"",occ:""},test:"true",mode:"",addFormVisible:!0}},created:function(){this.fetchReviews(),"edit"===this.mode&&this.getCurrentRev()},watch:{currentRev:function(){"edit"===this.mode&&this.getCurrentRev()},mode:function(){"edit"===this.mode?this.getCurrentRev():(this.review={},this.photoUrl="")}},computed:n({},Object(r.e)("reviews",{reviews:function(e){return e.reviews}}),{},Object(r.e)("reviews",{currentRev:function(e){return e.currentRev}}),{image:function(){return"https://webdev-api.loftschool.com/".concat(this.currentRev.photo)}}),methods:n({},Object(r.b)("message",["showTooltip"]),{},Object(r.b)("reviews",["addReview","fetchReviews","updateReviews"]),{addNewReview:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,regeneratorRuntime.awrap(this.addReview(this.review));case 3:e.sent,console.log("Ok"),this.review.photo="",this.review.occ="",this.review.text="",this.review.author="",console.log("wdwdwd"),this.showTooltip({type:"success",text:"Отзыв успешно добавлен!"}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),this.showTooltip({type:"error",text:e.t0});case 16:case"end":return e.stop()}}),null,this,[[0,13]])},updateUserRev:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("dwdw"),e.next=4,regeneratorRuntime.awrap(this.updateReviews(this.review));case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),null,this,[[0,6]])},loadPhoto:function(e){var t=e.target.files[0];this.review.photo=t,this.getPhoto(t)},getPhoto:function(e){var t=this,i=new FileReader;try{i.readAsDataURL(e),i.onload=function(){t.photoUrl=i.result}}catch(e){}},hideThisForm:function(){this.addFormVisible=!this.addFormVisible},showAddForm:function(e){this.mode=e,this.addFormVisible=!1},getCurrentRev:function(){this.review=n({},this.currentRev),this.review.photo=""},closeAddForm:function(){this.addFormVisible=!0}})},c=(i(431),i(96)),u=Object(c.a)(l,s,[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"group__left-text"},[this._v("Добавить фото"),t("div",{staticClass:"group__left"})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"new__item-btn"},[t("div",{staticClass:"new__item-plus"}),t("div",{staticClass:"new__text"},[this._v("Добавить отзыв")])])}],!1,null,null,null);u.options.__file="src/admin/components/pages/admin-new.vue";t.default=u.exports}}]);